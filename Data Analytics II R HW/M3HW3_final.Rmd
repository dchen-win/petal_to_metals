---
title: "ST 518 HW3"
author: "Cindy Chen"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine : xelatex 
---
1. (4 points) A researcher is interested in studying how (if?) GRE (Graduate Record Exam scores), GPA
(grade point average) and prestige of undergraduate institution are associated with admission into
graduate school. The response variable, Admit, is a binary variable (1 == admit). This dataset can
be found in admissions.csv available for download right underneath where you downloaded/opened
this homework assignment. Treat the variables GRE and GPA as continuous, and treat RANK, which
takes values 1 through 4, as a factor variable. A rank of 1 indicates that the student’s undergraduate
institution has the highest prestige, while a rank of 4 indicates that it has the lowest prestige.
(a) Fit a logistic regression model to these data, with the variable admit as the response and gpa,
gre, and rank as explanatory variables. Fit another model without gre. Comment on how
these models are different.



```{r}
# Relative path to the CSV file
csv_path <- "admissions.csv"

# Specify target column names
col_names <- c("admit", "gre", "gpa", "rank")

# Read the CSV file
admit_data <- read.csv(csv_path, skip = 58, 
                 header = TRUE, col.names = col_names, sep = ",")

head(admit_data)


```

```{r}
LRM = glm(admit ~ gre + gpa + rank ,data=admit_data,family=binomial(link="logit"))
summary(LRM)
```
```{r}
LRM_update = glm(admit ~ gpa + rank ,data=admit_data,family=binomial(link="logit"))
summary(LRM_update)
```

Answer:
In LRM model, the Residual Deviance(390.30) is significantly lower than the Null 
Deviance(418.51), it suggests that the model significantly improves the fit 
compared to the null model.
Therefore, the overall model appears to be statistically significant based on 
the chi-squared test and the significance of individual predictor variables. 
Both gpa and rank are significant predictors of admission status and gre is not
significant predictors of admission status.

In LRM_update model, the Residual Deviance(392.28) is significantly lower than 
the Null Deviance(418.51), it suggests that the model significantly improves the 
fit compared to the null model.
Therefore, the overall model appears to be statistically significant based on 
the chi-squared test and the significance of individual predictor variables. 
Both gpa and rank are significant predictors of admission status.

In summary, the higher residual deviance and higher p-values in the updated model 
(LRM_update) suggest that it may have a worse fit and less statistically 
significant predictors when it compared to the initial model (LRM). This indicates 
that excluding the gre variable from the model may not be justified based on the 
provided data and it leads to a model with weaker explanatory.

b) Produce a scatterplot of admit against GPA and overlay 4 separate fitted lines, one for each
rank, from the regression with gpa and rank as explanatory variables.

```{r}

library(ggplot2)

admit_data$rank <- factor(admit_data$rank)

ggplot(admit_data, aes(x = gpa, y = admit, color = rank)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, method.args = 
                list(family = "binomial"), aes(group = rank)) +
  labs(title = "Scatterplot of Admit against GPA by Rank",
       x = "GPA",
       y = "Admit",
       color = "Rank") +

  theme_minimal()

```



(c) Write a short paragraph discussing your findings.

Answer:
From the chart, we could see that there is strong correlation between Rank and GPA.
However, it is hard to show the relationship between GPA and Admit from the chart
since Admit is binomial variables.

2. (3 points) In 1846, the Donner and Reed families left Springfield, Illinois, 
for California by covered wagon. Along the way, more families and individuals 
joined the Donner Party, as it came to be known, until it reached its full size 
of 87 people. The group become stranded in the eastern Sierra
Nevada mountains when the region was hit by heavy snows in late October. By the 
time the last survivor was rescued in April 1847, 40 of the 87 members had died 
from famine and exposure to extreme cold.
(a) One assumption underlying the correct use of logistic regression is that 
observations are independent of each other. Is there some basis for thinking 
this assumption might be violated in the Donner Party data?

Answer:
There might be a bias that the assumption of independence
amount observations could be violated in the Donner Party
data.
The members of groups are not isolated and may share experience. There might be interactions and decisions
within the group could influence individual survival chance.


(b) Why should one be reluctant to draw conclusions about the ratio of male and female odds of
survival for Donner Party members over 50? (Hint: Look again the graph of the Donner Party
data from lecture, where status is plotted against age.)

Answer:
There are several factors could have impact:
1) Sample size is small and it may lead to imprecise estimate.
2) The sample we choose may not represent the overall population. 
3) Other factors like age, physical health may have impact as 
well.


(c) In this week’s lecture, it was found that the estimated logisitic regression 
equation is:ˆ logit(p) = 1.63 − 0.078Age + 1.60 Female where Female is an 
indicator variable equal to one for females and zero for males. What is the
age at which the estimated probability of survival is 50% for women? What about 
for men?


Answer:
In this case, we will set female indicator as 1 and 0 for male.
For women:
1.63 - 0.078 * Age + 1.60 * 1 = 0.5
Age around equal to 35.

Therefore, the estimated probability of survival being 50% for women occurs at around 35.
For women:
1.63 - 0.078 * Age + 1.60 * 0 = 0.5
Age around equal to 14.5.

The estimated probability of survival being 50% for men occurs at around 14.5.

3. (3 points) The common brushtail possum of the Australia region is a bit cuter than its distant cousin,
the American opossum. We consider 104 brushtail possums from two regions in Australia, where the
possums may be considered a random sample from a larger population. The first region is Victoria,
and the second region consists of New South Wales and Queensland.
We use logistic regression to differentiate between possums in these two regions. The outcome
variable population takes value 1 if the possum is from Victoria and 0 if it is from New South
Wales and Queensland. Five predictors are considered: sex_male, an indicator for a possum being
male, head_length, skull_width, total_length, and tail_length. A full and reduced logistic
model are summarized in the following table:

Full Model Reduced Model
Estimate SE Z Pr(> |Z|) Estimate SE Z Pr(> |Z|)
(Intercept) 39.2349 11.5368 3.40 0.0007 33.5095 9.9053 3.38 0.0007
sex_male -1.2376 0.6662 -1.86 0.0632 -1.4207 0.6457 -2.20 0.0278
head_length -0.1601 0.1386 -1.16 0.2480
skull_width -0.2012 0.1327 -1.52 0.1294 -0.2787 0.1226 -2.27 0.0231
total_length 0.6488 0.1531 4.24 0.0000 0.5687 0.1322 4.30 0.0000
tail_length -1.8708 0.3741 -5.00 0.0000 -1.8057 0.3599 -5.02 0.0000
(a) The variable head_length was taken out for the reduced model based on its 
p-value in the full
model. Why did the remaining estimates change between the two models?

Answer:
In this case, the predictors are correlated between each other,
when we remove one predictor from the model impact the estimate
of the remaining predictors.
Also when head_length was removed from the reduced model, the
correlations between head_length and the other predictors were
no longer accounted in the model. The correlations get recalculated based on the 
reduced model. So it leads to the changes.

(b) Suppose we see a male possum with a 65 mm wide skull, a 32 cm long tail, and a total length
of 80 cm. If we know this possum was captured in the wild in Australia, what is the probability
that this possum is from Victoria (using the reduced model)?


```{r}
skull_width <- 65
tail_length <- 32
total_length <- 80
sex_male <- 1
intercepet <- 33.5095
ce_sex_male <- 1.4207
ce_skull_width <- 0.2787
ce_total_length <- 0.5687
ce_tail_length <- 1.8057

logit_p <- intercepet - (ce_sex_male * sex_male) - (ce_skull_width * skull_width) +
  (ce_total_length * total_length) - (ce_tail_length * tail_length)
logit_p

probability <- exp(logit_p) / (1 + exp(logit_p))
probability
```
Therefore, the probability that this possum is from Victoria 
is approximately 0.843816


